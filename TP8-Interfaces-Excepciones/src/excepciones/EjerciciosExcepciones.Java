package excepciones;

import java.io.*;
import java.util.Scanner;

public class EjerciciosExcepciones {
    
    public static void divisionSegura() {
        Scanner scanner = new Scanner(System.in);
        System.out.println("\n=== EJERCICIO 1: DIVISI√ìN SEGURA ===");
        
        try {
            System.out.print("Ingrese el dividendo: ");
            int dividendo = scanner.nextInt();
            System.out.print("Ingrese el divisor: ");
            int divisor = scanner.nextInt();
            
            int resultado = dividendo / divisor;
            System.out.println("Resultado: " + dividendo + " / " + divisor + " = " + resultado);
        } catch (ArithmeticException e) {
            System.out.println("‚ùå Error: No se puede dividir por cero");
        } catch (Exception e) {
            System.out.println("‚ùå Error: Entrada inv√°lida");
        }
    }
    
    public static void conversionCadenaNumero() {
        Scanner scanner = new Scanner(System.in);
        System.out.println("\n=== EJERCICIO 2: CONVERSI√ìN DE CADENA A N√öMERO ===");
        
        try {
            System.out.print("Ingrese un n√∫mero: ");
            String entrada = scanner.nextLine();
            
            int numero = Integer.parseInt(entrada);
            System.out.println("‚úì Conversi√≥n exitosa. N√∫mero ingresado: " + numero);
            System.out.println("El doble del n√∫mero es: " + (numero * 2));
        } catch (NumberFormatException e) {
            System.out.println("‚ùå Error: La cadena ingresada no es un n√∫mero v√°lido");
        }
    }
    
    public static void lecturaArchivo() {
        Scanner scanner = new Scanner(System.in);
        System.out.println("\n=== EJERCICIO 3: LECTURA DE ARCHIVO ===");
        System.out.print("Ingrese el nombre del archivo: ");
        String nombreArchivo = scanner.nextLine();
        
        BufferedReader reader = null;
        
        try {
            reader = new BufferedReader(new FileReader(nombreArchivo));
            String linea;
            int numeroLinea = 1;
            
            System.out.println("\n--- Contenido del archivo ---");
            while ((linea = reader.readLine()) != null) {
                System.out.println(numeroLinea + ": " + linea);
                numeroLinea++;
            }
            System.out.println("--- Fin del archivo ---\n");
        } catch (FileNotFoundException e) {
            System.out.println("‚ùå Error: El archivo no existe");
        } catch (IOException e) {
            System.out.println("‚ùå Error al leer el archivo");
        } finally {
            try {
                if (reader != null) {
                    reader.close();
                    System.out.println("‚úì Archivo cerrado correctamente");
                }
            } catch (IOException e) {
                System.out.println("‚ùå Error al cerrar el archivo");
            }
        }
    }
    
    public static void validarEdad(int edad) throws EdadInvalidaException {
        if (edad < 0) {
            throw new EdadInvalidaException("La edad no puede ser negativa");
        }
        if (edad > 120) {
            throw new EdadInvalidaException("La edad no puede ser mayor a 120 a√±os");
        }
        System.out.println("‚úì Edad v√°lida: " + edad + " a√±os");
    }
    
    public static void excepcionPersonalizada() {
        Scanner scanner = new Scanner(System.in);
        System.out.println("\n=== EJERCICIO 4: EXCEPCI√ìN PERSONALIZADA ===");
        
        try {
            System.out.print("Ingrese su edad: ");
            int edad = scanner.nextInt();
            
            validarEdad(edad);
            
            if (edad < 18) {
                System.out.println("Categor√≠a: Menor de edad");
            } else if (edad < 65) {
                System.out.println("Categor√≠a: Adulto");
            } else {
                System.out.println("Categor√≠a: Adulto mayor");
            }
        } catch (EdadInvalidaException e) {
            System.out.println("‚ùå Error de validaci√≥n: " + e.getMessage());
        } catch (Exception e) {
            System.out.println("‚ùå Error: Debe ingresar un n√∫mero entero");
        }
    }
    
    public static void tryWithResources() {
        Scanner scanner = new Scanner(System.in);
        System.out.println("\n=== EJERCICIO 5: TRY-WITH-RESOURCES ===");
        System.out.print("Ingrese el nombre del archivo: ");
        String nombreArchivo = scanner.nextLine();
        
        try (BufferedReader reader = new BufferedReader(new FileReader(nombreArchivo))) {
            String linea;
            int numeroLinea = 1;
            int totalLineas = 0;
            int totalCaracteres = 0;
            
            System.out.println("\n--- Contenido del archivo ---");
            while ((linea = reader.readLine()) != null) {
                System.out.println(numeroLinea + ": " + linea);
                numeroLinea++;
                totalLineas++;
                totalCaracteres += linea.length();
            }
            
            System.out.println("--- Fin del archivo ---");
            System.out.println("\nüìä Estad√≠sticas:");
            System.out.println("   Total de l√≠neas: " + totalLineas);
            System.out.println("   Total de caracteres: " + totalCaracteres);
            System.out.println("   ‚úì Recurso cerrado autom√°ticamente\n");
        } catch (FileNotFoundException e) {
            System.out.println("‚ùå Error: El archivo no existe");
        } catch (IOException e) {
            System.out.println("‚ùå Error al leer el archivo");
        }
    }
    
    public static void crearArchivoPrueba() {
        String nombreArchivo = "archivo_prueba.txt";
        
        try (BufferedWriter writer = new BufferedWriter(new FileWriter(nombreArchivo))) {
            writer.write("Esta es la primera l√≠nea del archivo de prueba\n");
            writer.write("Segunda l√≠nea con m√°s contenido\n");
            writer.write("Tercera l√≠nea para demostrar la lectura\n");
            writer.write("√öltima l√≠nea del archivo\n");
            
            System.out.println("‚úì Archivo de prueba creado exitosamente");
        } catch (IOException e) {
            System.out.println("‚ùå Error al crear archivo de prueba");
        }
    }
    
    public static void main(String[] args) {
        Scanner scanner = new Scanner(System.in);
        boolean continuar = true;
        
        System.out.println("‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó");
        System.out.println("‚ïë  EJERCICIOS DE MANEJO DE EXCEPCIONES      ‚ïë");
        System.out.println("‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù");
        
        while (continuar) {
            System.out.println("\n--- MEN√ö PRINCIPAL ---");
            System.out.println("1. Divisi√≥n segura");
            System.out.println("2. Conversi√≥n de cadena a n√∫mero");
            System.out.println("3. Lectura de archivo (con finally)");
            System.out.println("4. Validaci√≥n de edad (excepci√≥n personalizada)");
            System.out.println("5. Lectura de archivo (try-with-resources)");
            System.out.println("6. Crear archivo de prueba");
            System.out.println("0. Salir");
            System.out.print("\nSeleccione una opci√≥n: ");
            
            try {
                int opcion = scanner.nextInt();
                scanner.nextLine();
                
                switch (opcion) {
                    case 1: divisionSegura(); break;
                    case 2: conversionCadenaNumero(); break;
                    case 3: lecturaArchivo(); break;
                    case 4: excepcionPersonalizada(); break;
                    case 5: tryWithResources(); break;
                    case 6: crearArchivoPrueba(); break;
                    case 0:
                        continuar = false;
                        System.out.println("\n¬°Hasta luego! üëã");
                        break;
                    default:
                        System.out.println("‚ùå Opci√≥n inv√°lida");
                }
            } catch (Exception e) {
                System.out.println("‚ùå Error en la entrada del men√∫");
                scanner.nextLine();
            }
        }
        
        scanner.close();
    }
}